---
title: "AHC032 解説放送メモ"
date: 2024-05-03
---

解説放送みたメモ

## 解説放送メモ

+ 解説放送: [https://www.youtube.com/watch?v=9JS0wXXNiZk](https://www.youtube.com/watch?v=9JS0wXXNiZk)
+ eijirou さん解法: [https://atcoder.jp/contests/ahc032/submissions?f.User=eijirou](https://atcoder.jp/contests/ahc032/submissions?f.User=eijirou)
+ wata さん解法: [https://atcoder.jp/contests/ahc032/submissions/52151408](https://atcoder.jp/contests/ahc032/submissions/52151408)

## 考察

+ 3*3 のマスをすべて `MOD*0.8` 以上にするためには 5^9 通り候補がほしい
    + (ランダムに与えられたスタンプで 1 マスを `MOD*4/5` 以上にできる確率 `1/5`)
+ 近傍がなめらかでないので、焼きなましなどの局所探索は不適
+ 同じ 9 マスを操作するなら、左上の点は分散させたほうが場合の数が増える 

## ビームサーチ

+ 評価関数: $確定スコア + K * MOD * (1 - 進行度) * 残りの操作回数$ ($K$ はハイパーパラメータ)
    + 進行度が小さい場合は、後でより上手く揃えられるように操作回数を残したい

### 「操作回数別でビームを分ける」とは

wata さんの実装では操作回数別でビームを分けている。  
ここでいうビームサーチは幅優先のビームサーチで「確定マス数」が深さに対応する。  
確定マス数を C とする。これを操作回数の基準として $\pm W$ 回の操作回数のズレを許容し、そのズレ幅ごとにビームをもつ。  
(例: コードの `beam[W]` はズレ幅 0 のビーム)

### 揃えるマスの順

[35:30](https://www.youtube.com/live/9JS0wXXNiZk?si=84Nipkh2IA8TtWgq&t=2128)

+ 揃える順序は 3 マス揃えが連続しないほうが良い
+ ビームサーチの「確定スコア/確定マス数」を可視化することで確認している

## 高速化

+ 不要なスタンプをできるだけ減らす工夫をしている
 + スタンプを右上の値で分類し、右上マスを良い値にできるスタンプの候補を絞り込めるようにするなど

### K 分木の話

wata さん実装の `Searcher` がそれ。

やることは「3マス揃え」で話していることとほとんど同じ。  
MOD を K 個の区間に分けて、スタンプの 1 マス目の値で K 分割、2 マス目の値で K 分割 …  
のように分割する木の深さが i マス目の分割となる K 分木を作り、良いスタンプの探索を高速にできるようにする。
